{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useUser}from'@clerk/clerk-react';import{Link}from'react-router-dom';import BaseLayout from'../components/layout/BaseLayout';import{getEmailError,getPhoneError}from'../utils/validation';import apiService from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function ProfilePage(){const{user}=useUser();const[profile,setProfile]=useState(null);const[isEditing,setIsEditing]=useState(false);const[isLoading,setIsLoading]=useState(true);const[isSaving,setIsSaving]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState('');const[fieldErrors,setFieldErrors]=useState({});// Fetch user profile from API\nuseEffect(()=>{const fetchProfile=async()=>{if(user){try{setIsLoading(true);setError('');// Try to fetch existing profile from API\nconst existingProfile=await apiService.getUserProfile(user.id);if(existingProfile){setProfile(existingProfile);}else{var _user$primaryEmailAdd;// Create default profile from Clerk user data\nconst defaultProfile={firstName:user.firstName||'',lastName:user.lastName||'',email:((_user$primaryEmailAdd=user.primaryEmailAddress)===null||_user$primaryEmailAdd===void 0?void 0:_user$primaryEmailAdd.emailAddress)||'',phone:'',dateOfBirth:'',gender:'',communicationsAccepted:false,registrationStatus:'not_registered'};setProfile(defaultProfile);}}catch(err){var _user$primaryEmailAdd2;console.error('Failed to fetch profile:',err);setError('Failed to load profile. Please try again.');// Fallback to default profile\nconst defaultProfile={firstName:user.firstName||'',lastName:user.lastName||'',email:((_user$primaryEmailAdd2=user.primaryEmailAddress)===null||_user$primaryEmailAdd2===void 0?void 0:_user$primaryEmailAdd2.emailAddress)||'',phone:'',dateOfBirth:'',gender:'',communicationsAccepted:false,registrationStatus:'not_registered'};setProfile(defaultProfile);}finally{setIsLoading(false);}}};fetchProfile();},[user]);const handleInputChange=e=>{const{name,value,type}=e.target;const checked=e.target.checked;setProfile(prev=>prev?{...prev,[name]:type==='checkbox'?checked:value}:null);};const handleSave=async()=>{if(!user||!profile)return;setIsSaving(true);setError('');setSuccess('');setFieldErrors({});// Validate email and phone\nconst errors={};const emailError=getEmailError(profile.email);if(emailError)errors.email=emailError;const phoneError=getPhoneError(profile.phone);if(phoneError)errors.phone=phoneError;if(Object.keys(errors).length>0){setFieldErrors(errors);setError('Please fix the errors above.');setIsSaving(false);return;}try{await apiService.updateUserProfile(user.id,profile);setSuccess('Profile updated successfully!');setIsEditing(false);}catch(err){console.error('Failed to save profile:',err);setError('Failed to save profile. Please try again.');}finally{setIsSaving(false);}};const handleCancel=()=>{// Reset to original profile data\nif(user){var _user$primaryEmailAdd3;const defaultProfile={firstName:user.firstName||'',lastName:user.lastName||'',email:((_user$primaryEmailAdd3=user.primaryEmailAddress)===null||_user$primaryEmailAdd3===void 0?void 0:_user$primaryEmailAdd3.emailAddress)||'',phone:'',dateOfBirth:'',gender:'',communicationsAccepted:false,registrationStatus:'not_registered'};setProfile(defaultProfile);}setIsEditing(false);setError('');setSuccess('');setFieldErrors({});};if(isLoading){return/*#__PURE__*/_jsx(BaseLayout,{children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-pumpkin text-xl\",children:\"Loading profile...\"})})})});}if(!profile){return/*#__PURE__*/_jsx(BaseLayout,{children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-red-400 text-xl mb-4\",children:\"Profile not found\"}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"text-pumpkin hover:text-deeporange\",children:\"Return to Home\"})]})})});}return/*#__PURE__*/_jsx(BaseLayout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gunmetal bg-opacity-95 border-2 border-pumpkin rounded-xl p-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-pumpkin\",children:\"Profile Information\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:!isEditing?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(true),className:\"px-4 py-2 rounded bg-pumpkin text-black font-bold hover:bg-deeporange transition-colors\",children:\"Edit Profile\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCancel,className:\"px-4 py-2 rounded border-2 border-pumpkin text-pumpkin font-bold hover:bg-pumpkin hover:text-black transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,disabled:isSaving,className:`px-4 py-2 rounded font-bold transition-colors ${isSaving?'bg-gray-600 text-gray-400 cursor-not-allowed':'bg-pumpkin text-black hover:bg-deeporange'}`,children:isSaving?'Saving...':'Save Changes'})]})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-900/50 border border-red-500 rounded text-red-300\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-900/50 border border-green-500 rounded text-green-300\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-black bg-opacity-30 rounded border border-pumpkin\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-300\",children:\"Registration Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:`font-bold ${profile.registrationStatus==='registered'?'text-green-400':'text-yellow-400'}`,children:profile.registrationStatus==='registered'?'Registered':'Not Registered'})]}),profile.registrationStatus==='registered'&&profile.teamId&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-300\",children:[\"\\u2022 Team ID: \",profile.teamId]})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"First Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"firstName\",value:profile.firstName,onChange:handleInputChange,disabled:!isEditing,className:`w-full p-3 rounded bg-black border border-pumpkin text-white focus:outline-none focus:ring-2 focus:ring-pumpkin ${!isEditing?'opacity-50 cursor-not-allowed':''}`})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"Last Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"lastName\",value:profile.lastName,onChange:handleInputChange,disabled:!isEditing,className:`w-full p-3 rounded bg-black border border-pumpkin text-white focus:outline-none focus:ring-2 focus:ring-pumpkin ${!isEditing?'opacity-50 cursor-not-allowed':''}`})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:profile.email,onChange:handleInputChange,disabled:!isEditing,className:`w-full p-3 rounded bg-black border border-pumpkin text-white focus:outline-none focus:ring-2 focus:ring-pumpkin ${!isEditing?'opacity-50 cursor-not-allowed':''}`}),fieldErrors.email&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 text-red-400 text-sm\",children:typeof fieldErrors.email==='string'?fieldErrors.email:fieldErrors.email.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",value:profile.phone,onChange:handleInputChange,disabled:!isEditing,placeholder:\"(555) 123-4567\",className:`w-full p-3 rounded bg-black border border-pumpkin text-white focus:outline-none focus:ring-2 focus:ring-pumpkin ${!isEditing?'opacity-50 cursor-not-allowed':''}`}),fieldErrors.phone&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 text-red-400 text-sm\",children:fieldErrors.phone})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"Date of Birth\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"dateOfBirth\",value:profile.dateOfBirth,onChange:handleInputChange,disabled:!isEditing,className:`w-full p-3 rounded bg-black border border-pumpkin text-white focus:outline-none focus:ring-2 focus:ring-pumpkin ${!isEditing?'opacity-50 cursor-not-allowed':''}`})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-300 mb-1\",children:\"Gender\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"gender\",value:profile.gender,onChange:handleInputChange,disabled:!isEditing,className:`w-full p-3 rounded bg-black border border-pumpkin text-white focus:outline-none focus:ring-2 focus:ring-pumpkin ${!isEditing?'opacity-50 cursor-not-allowed':''}`,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Gender\"}),/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"Male\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"Female\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"}),/*#__PURE__*/_jsx(\"option\",{value:\"prefer-not-to-say\",children:\"Prefer not to say\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-4\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-start gap-3 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"communicationsAccepted\",checked:profile.communicationsAccepted,onChange:handleInputChange,disabled:!isEditing,className:`mt-1 w-4 h-4 text-pumpkin bg-black border-pumpkin rounded focus:ring-pumpkin focus:ring-2 ${!isEditing?'opacity-50 cursor-not-allowed':''}`}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-300\",children:\"I consent to receive communications about league activities, schedules, and updates via email.\"})]})})]})]}),profile.registrationStatus==='registered'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gunmetal bg-opacity-95 border-2 border-pumpkin rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-pumpkin mb-4\",children:\"League Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-300 mb-2\",children:\"Current Team\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-pumpkin font-bold\",children:[\"Team ID: \",profile.teamId||'Not assigned']})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-300 mb-2\",children:\"Registration Date\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:profile.registrationDate?new Date(profile.registrationDate).toLocaleDateString():'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-300 mb-2\",children:\"Season Status\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-400\",children:\"Active\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-300 mb-2\",children:\"Next Game\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:\"Tuesday, 6:00 PM at Salem Common\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gunmetal bg-opacity-95 border-2 border-pumpkin rounded-xl p-6 mt-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-pumpkin mb-4\",children:\"Quick Actions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/rules\",className:\"p-4 bg-black bg-opacity-30 rounded-lg border border-pumpkin hover:bg-pumpkin hover:text-black transition-colors text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl mb-2\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:\"View Rules\"})]}),/*#__PURE__*/_jsxs(Link,{to:\"/\",className:\"p-4 bg-black bg-opacity-30 rounded-lg border border-pumpkin hover:bg-pumpkin hover:text-black transition-colors text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl mb-2\",children:\"\\uD83D\\uDCC5\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:\"View Schedule\"})]}),/*#__PURE__*/_jsxs(Link,{to:\"/contact\",className:\"p-4 bg-black bg-opacity-30 rounded-lg border border-pumpkin hover:bg-pumpkin hover:text-black transition-colors text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl mb-2\",children:\"\\uD83D\\uDCDE\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:\"Contact League\"})]})]})]})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}